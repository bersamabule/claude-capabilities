# Codebase Knowledge Graph

This directory contains the semantic knowledge graph of your codebase.

## Files

| File | Purpose |
|------|---------|
| `graph.json` | The full knowledge graph (generated) |
| `README.md` | This overview (auto-updated on build) |

## Commands

| Command | Description |
|---------|-------------|
| `/kg-build` | Build or rebuild the full knowledge graph |
| `/kg-query [question]` | Query the graph in natural language |
| `/kg-update` | Incrementally update after changes |

## What's Indexed

The knowledge graph captures:

### Nodes (Entities)
- **Files**: Source files with purpose, layer, and type
- **Functions**: Exported functions with signatures and relationships
- **Classes**: Classes with inheritance and implementation
- **Interfaces/Types**: Type definitions and their usage
- **Modules**: Logical groupings of related code

### Edges (Relationships)
- **imports**: File A imports from File B
- **exports**: File exports Function/Class
- **calls**: Function A calls Function B
- **extends**: Class A extends Class B
- **implements**: Class implements Interface
- **uses**: Function uses external package

### Metadata
- **Patterns**: Detected architectural patterns
- **Domains**: Logical domain groupings (auth, users, payments, etc.)
- **Layers**: Application layers (routes, services, models, etc.)
- **Hotspots**: Files with most dependents

## Example Queries

```
/kg-query What depends on UserModel?
/kg-query What would break if I change the auth service?
/kg-query Show me all API endpoints
/kg-query What is the architecture of this codebase?
/kg-query How does data flow from API to database?
```

## Graph Schema

```json
{
  "version": "1.0",
  "generated": "ISO-8601 timestamp",
  "project": {
    "name": "project-name",
    "type": "node-typescript | python | rust | go",
    "entryPoints": ["main files"],
    "layers": ["detected layers"]
  },
  "nodes": {
    "files": [{ "path", "type", "purpose", "layer", "imports", "exports" }],
    "functions": [{ "name", "file", "params", "returns", "calls", "calledBy" }],
    "classes": [{ "name", "file", "extends", "implements", "methods" }]
  },
  "edges": {
    "imports": [{ "from", "to", "items" }],
    "calls": [{ "from", "to", "context" }],
    "extends": [{ "child", "parent" }]
  },
  "patterns": {
    "architecture": "detected-pattern-name",
    "detected": ["list", "of", "patterns"]
  },
  "domains": {
    "domain-name": ["list", "of", "files"]
  }
}
```

## When to Rebuild

Run `/kg-build` when:
- Starting work on a new codebase
- After major refactoring
- Graph is more than 1-2 weeks old
- Queries return unexpected results

Run `/kg-update` when:
- After adding new files
- After changing imports/exports
- After smaller refactoring tasks

---

*Generated by Codebase Knowledge Graph capability*
